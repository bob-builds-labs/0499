- name: Start and stop VM´s
  hosts: localhost
  connection: local
  gather_facts: false
  tasks:  
  - name: Look up VM´s in the inventory
    register: search_result
    vmware.vmware_rest.vcenter_vm_info:
      filter_names: {{ vm_names }}
  - name: get vm infos
    register: vm_info
    vmware.vmware_rest.vcenter_vm_info:
      vm: "{{ item.vm }}"
    with_items: "{{ search_result }}"
